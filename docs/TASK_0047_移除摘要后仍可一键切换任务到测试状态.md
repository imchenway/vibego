# /TASK_0047 ç§»é™¤æ‘˜è¦åä»å¯ä¸€é”®åˆ‡æ¢ä»»åŠ¡åˆ°æµ‹è¯•çŠ¶æ€ï¼ˆYOLOï¼‰

## 1. èƒŒæ™¯

æ­¤å‰åœ¨æç¤ºè¯/æ¨¡å‹å›å¤æœ«å°¾ä¼šå‡ºç°â€œç‚¹å‡»ç”Ÿæˆä»»åŠ¡æ‘˜è¦ï¼š`/task_summary_request_TASK_0001`â€ä¸€ç±»å¯ç‚¹å‡»å‘½ä»¤ï¼Œç‚¹å‡»åä¼šè§¦å‘æ‘˜è¦è¯·æ±‚ï¼Œå¹¶**è‡ªåŠ¨æŠŠä»»åŠ¡çŠ¶æ€åˆ‡åˆ° `test`**ã€‚

ç°åœ¨æç¤ºè¯ä¸­å·²ç§»é™¤æ‘˜è¦ç›¸å…³å“åº”åï¼Œç¼ºå°‘ä¸€ä¸ªâ€œåƒç‚¹å‡»ç”Ÿæˆæ‘˜è¦ä¸€æ ·â€çš„**ä¸€é”®å…¥å£**æ¥æŠŠä»»åŠ¡åˆ‡æ¢åˆ°æµ‹è¯•çŠ¶æ€ã€‚

## 2. ç›®æ ‡

- ä¸ä¾èµ–â€œæ‘˜è¦è¾“å‡º/å‘½ä»¤æ–‡æ¡ˆâ€ï¼Œä¹Ÿèƒ½ä¸€é”®æŠŠä»»åŠ¡åˆ‡åˆ° **ğŸ§ª æµ‹è¯•ä¸­**ã€‚
- å…¥å£å°½é‡è´´è¿‘ç”¨æˆ·é˜…è¯»æ¨¡å‹å›å¤çš„åœºæ™¯ï¼ˆæ— éœ€è·³è½¬åˆ°ä»»åŠ¡è¯¦æƒ…ï¼‰ã€‚

## 3. æ–¹æ¡ˆï¼ˆæœ€ç»ˆå®ç° âœ…ï¼‰

åœ¨ **â€œæ¨¡å‹ç­”æ¡ˆæ¶ˆæ¯â€** åº•éƒ¨çš„ InlineKeyboard è¿½åŠ æŒ‰é’®ï¼š

- `ğŸ§ª åˆ‡åˆ°æµ‹è¯•`

ç‚¹å‡»åï¼š

- è‹¥ä»»åŠ¡å·²æ˜¯ `test`ï¼šä»… toast æç¤ºâ€œä»»åŠ¡å·²å¤„äºæµ‹è¯•çŠ¶æ€â€
- è‹¥å¯æ›´æ–°ï¼šè°ƒç”¨ `TASK_SERVICE.update_task(..., status="test")` æ›´æ–°ä»»åŠ¡çŠ¶æ€ï¼Œå¹¶å‘é€ä¸€æ¡ç¡®è®¤æ¶ˆæ¯ï¼ˆä¸è¦†ç›–åŸæ¨¡å‹æ¶ˆæ¯ï¼‰

## 4. ç°çŠ¶å®šä½ï¼ˆå¯éªŒè¯ï¼‰

- æ¨¡å‹è¾“å‡ºæŠ•é€’ï¼š`bot.py` â†’ `_deliver_pending_messages(...)` â†’ `reply_large_text(..., reply_markup=...)`
- ç°æœ‰â€œæ¨¡å‹ç­”æ¡ˆæ¶ˆæ¯â€æŒ‰é’®ï¼š`bot.py` â†’ `_build_model_quick_reply_keyboard()`

## 5. å®ç°è¦ç‚¹ï¼ˆDesignï¼‰

1) **ä¼šè¯ç»‘å®šä»»åŠ¡**
- æ–°å¢å†…å­˜æ˜ å°„ï¼š`SESSION_TASK_BINDINGS[session_key] = task_id`
- ç»‘å®šæ—¶æœºï¼š
  - `_push_task_to_model(...)` æˆåŠŸæ‹¿åˆ° `session_path` åç»‘å®š
  - `_request_task_summary(...)` æˆåŠŸæ‹¿åˆ° `session_path` åç»‘å®šï¼ˆä¿æŒä¸€è‡´æ€§ï¼‰

2) **åŠ¨æ€æ„å»ºæŒ‰é’®**
- `_deliver_pending_messages(...)` æ ¹æ® `session_key` æŸ¥åˆ° `task_id` åï¼Œæ„é€ åŒ…å«â€œğŸ§ª åˆ‡åˆ°æµ‹è¯•â€çš„é”®ç›˜ï¼ˆå¦åˆ™ä»…ä¿ç•™åŸå¿«æ·å›å¤æŒ‰é’®ï¼‰

3) **å›è°ƒå¤„ç†**
- æ–°å¢å›è°ƒï¼š`model:task_to_test:<TASK_ID>`ï¼ˆä¸å¤ç”¨ `task:status:*`ï¼Œé¿å…æŠŠæ¨¡å‹å›å¤æ¶ˆæ¯æ›¿æ¢æˆä»»åŠ¡è¯¦æƒ…ï¼‰

## 6. éªŒæ”¶æ ‡å‡†ï¼ˆACï¼Œå¯æµ‹è¯•ï¼‰

1) å¯¹å·²ç»‘å®šä»»åŠ¡çš„ä¼šè¯ï¼Œæ¨¡å‹è¾“å‡ºæ¶ˆæ¯åº•éƒ¨å±•ç¤º `ğŸ§ª åˆ‡åˆ°æµ‹è¯•`ã€‚
2) ç‚¹å‡»åä»»åŠ¡çŠ¶æ€å˜ä¸º `test`ï¼Œå¹¶æ”¶åˆ°ç¡®è®¤æç¤ºï¼›åŸæ¨¡å‹æ¶ˆæ¯ä¸è¢«ç¼–è¾‘è¦†ç›–ã€‚
3) è‹¥ä»»åŠ¡å·²æ˜¯ `test`ï¼Œä¸è°ƒç”¨æ›´æ–°æ¥å£ï¼Œä»…æç¤ºâ€œå·²å¤„äºæµ‹è¯•çŠ¶æ€â€ã€‚
4) ä»»åŠ¡ä¸å­˜åœ¨/ID æ— æ•ˆæ—¶ï¼Œå¼¹çª—æç¤ºåŸå› ã€‚

## 7. ç›¸å…³å®˜æ–¹èµ„æ–™ï¼ˆEvidenceï¼‰

- Telegram Bot APIï¼šInlineKeyboardMarkup  
  https://core.telegram.org/bots/api#inlinekeyboardmarkup
- Telegram Bot APIï¼šInlineKeyboardButtonï¼ˆå« `callback_data` çº¦æŸï¼‰  
  https://core.telegram.org/bots/api#inlinekeyboardbutton
- Telegram Bot APIï¼šsendMessageï¼ˆæ”¯æŒ `reply_markup`ï¼‰  
  https://core.telegram.org/bots/api#sendmessage
- Telegram Bot APIï¼šsendDocumentï¼ˆæ”¯æŒ `reply_markup`ï¼‰  
  https://core.telegram.org/bots/api#senddocument

